\chapter{Implementation}
\label{chp:implementation}

\section{Vanishing Point Detection}

\subsection{Overview}

\subsection{Line Detection}

\subsection{Line Filtering}

\subsection{Vanishing Point Detection}

\subsection{Graphical User Interface}

\subsection{Where it Fails}

\section{Depth Perception and Obstruction Detection}

\subsection{Overview}

\subsection{The camera rig}

The two IP cameras were moved together to form a stereo camera. This stereo camera was used in two positions. The first camera position is on the pan-tilt module on the robot arm, see figure \ref{fig:figure}. The second position is just over the LIDAR in front of the robot arm base, see figure \ref{fig:figure}.  The workshop at ITK made a mounting bracket, so that the cameras could be placed over the LIDAR. In stereo vision, it is essential that the positions of the cameras relative to each other is constant. One problem encountered throughout the project was that the camera assemby, when placed either at the pan-tilt module and over the LIDAR, was not rigid enough. The severity of this problem was somewhat alleviated by wrapping a strap around both the cameras. This camera rig is ad hoc, i.e. suitable for the purpose of this project, but a better solution should be used for following projects.

\subsection{Calibration}

As mentioned in chapter \ref{chp:theory}, all cameras will have some distortion. If the distortion is too severe, as it often will be in the context of stereo vision, the camera must be calibrated. In addition, it was assumed that the image planes were located on the same plane, and that a projection pair, for example the projections $X_L$ and $X_R$ of an object $X$, form two equal epipolar lines, $e_1$ and $e_2$, on the two image planes. In practice, these conditions must be realized through stereo calibration. The second purpose of the calibration procedure is to relate the sensor data to real world quantities.

\paragraph{Single Camera Calibration}

\paragraph{Stereo Calibration}

\paragraph{Stereo Rectification}

%\begin{figure}
%\includegraphics[scale=•]{•}
%\end{figure}

\subsection{Stereo Matching}

\begin{figure}
\centering
 \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{OriginalExample}
        \caption{Left camera image.}
        \label{fig:OriginalExample}
    \end{subfigure}
    \begin{subfigure}[b]{0.45\textwidth}
        \includegraphics[width=\textwidth]{DispExample}
        \caption{Disparity map.}
        \label{fig:DispExample}
    \end{subfigure}
    \caption{\label{fig:StereoMatching}The result of StereoSGBM.}
\end{figure}

\subsection{Finding Obstructions}

\begin{wrapfigure}{r}{0.4\textwidth}
\centering
\subcaptionbox{$n = 10$ steps\label{cw_10}}{%
  \includegraphics[width=0.4\textwidth]{DepthLayer1}%
  }\par\medskip
\subcaptionbox{$n = 25$ steps\label{cw_25}}{%
  \includegraphics[width=0.4\textwidth]{DepthLayer2}%
  }\par\medskip        
\subcaptionbox{$n = 50$ steps\label{cw_50}}{%
  \includegraphics[width=0.4\textwidth]{DepthLayer4}%
  }
  \subcaptionbox{$n = 50$ steps\label{cw_55}}{%
  \includegraphics[width=0.4\textwidth]{DepthLayer5}%
  }
    \subcaptionbox{$n = 50$ steps\label{cw_56}}{%
  \includegraphics[width=0.4\textwidth]{DepthLayer6}%
  }
\caption{Classical Random Walk with various step sizes.}
\label{TS}
\end{wrapfigure}

\subsection{Distance Measurment}

\subsection{Problems Encountered During Implementation }